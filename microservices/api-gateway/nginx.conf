events {}

http {
  client_max_body_size 100M;

  server {
    listen 80;

    location /api/identity {
      # CORS now handled by microservices
      proxy_pass http://identity-service:3001;
      rewrite ^/api/identity/(.*) /$1 break;
    }

    location /api/catalog {
      # CORS now handled by microservices
      proxy_pass http://catalog-service:3002;
      rewrite ^/api/catalog/(.*) /$1 break;
    }

    location /api/orders {
      # CORS now handled by microservices
      proxy_pass http://order-service:3003;
      rewrite ^/api/orders/(.*) /$1 break;
      rewrite ^/api/orders$ / break;
    }

    location /api/bot {
      # CORS now handled by microservices
      proxy_pass http://ayurbot-service:8000;
      rewrite ^/api/bot/(.*) /$1 break;
    }

    location /api/notifications {
      # CORS now handled by microservices
      proxy_pass http://notification-service:3004;
      rewrite ^/api/notifications/(.*) /$1 break;
    }

    location /api/translate {
      # CORS now handled by microservices
      proxy_pass http://catalog-service:3002/translate;
    }

    location / {
      proxy_pass http://frontend:3000;
    }
  }
}
